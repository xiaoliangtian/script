#! /usr/bin/perl #-w
#use strict;
use Getopt::Long;
##############usage##############################
die "Usage:
    perl [script] -i [input_vcf] -o [output_file] -m [mother_column] -s [son_column] -f [father_column] -d [min_var_depth]

        -i  input: str txt or vcf file
        -o  output
        -m  mother_data_column
        -s  son_data_column
        -f  father_column
        -d  min_var_depth"
  unless @ARGV >= 1;

########################

my $in;
my $out;
my $mom;
my $son;
my $dad;
my $min;
my $ref;
my $rate;
Getopt::Long::GetOptions(
    'i=s' => \$in,
    'o=s' => \$out,
    'm:i' => \$mom,
    's:i' => \$son,
    "f:i" => \$dad,
    "d:i" => \$min,
    "r:f" => \$rate,

);

open IN, "<$in"
  or die "Cannot open file $in!\n";
open OUT, ">$out"
  or die "Cannot open file $out!\n";

my @son_ty;
my $son1;
my $mom_dad1;
my $mom_dad2;
my $mom_dad3;
my %hash1;
my $son_ty1;
my $son_ty2;
my $son_ty3;
my %hash;
my @result_p = "";
my @line3 = "";

my %len = (
    "D1S1646"        => "D1S1646",
    "D1GATA113"      => "D1GATA113",
    "D1S1597"        => "D1S1597",
    "D1S3669"        => "D1S3669",
    "D1S1676"        => "D1S1676",
    "D1S1598"        => "D1S1598",
    "D1S3734"        => "D1S3734",
    "D1S1162"        => "D1S1162",
    "D1S3733"        => "D1S3733",
    "D1S551"         => "D1S551",
    "D1S1588"        => "D1S1588",
    "D1S1631"        => "D1S1631",
    "D1GATA133A08"   => "GATA133A08",
    "D1S1600"        => "D1S1600",
    "D1S1653"        => "D1S1653",
    "D1S1679"        => "D1S1679",
    "D1S1677"        => "D1S1677",
    "D1S1589"        => "D1S1589",
    "D1S518"         => "D1S518",
    "D1S2141"        => "D1S2141",
    "D1S549"         => "D1S549",
    "D1S1644"        => "D1S1644",
    "D1S1656"        => "D1S1656",
    "D10S1435"       => "D10S1435",
    "D10S2474"       => "D10S2474",
    "D10S2481"       => "D10S2481",
    "D10S1426"       => "D10S1426",
    "D10S1208"       => "D10S1208",
    "D10S1221"       => "D10S1221",
    "D10S1428"       => "D10S1428",
    "D10S1432"       => "D10S1432",
    "D10S1427"       => "D10S1427",
    "D10S1239"       => "D10S1239",
    "D10S1246"       => "D10S1246",
    "D10S1425"       => "D10S1425",
    "D10S1230"       => "D10S1230",
    "D10S2322"       => "D10S2322",
    "D10S1248"       => "D10S1248",
    "D11TH01"        => "TH01",
    "D11S2362"       => "D11S2362",
    "D11S1997"       => "D11S1997",
    "D11S4465"       => "D11S4465",
    "D11S1999"       => "D11S1999",
    "D11S1981"       => "D11S1981",
    "D11S2364"       => "D11S2364",
    "D11S1392"       => "D11S1392",
    "D11S1393"       => "D11S1393",
    "D11S4960"       => "D11S4960",
    "D11S1367"       => "D11S1367",
    "D11S4952"       => "D11S4952",
    "D11S4951"       => "D11S4951",
    "D11S2000"       => "D11S2000",
    "D11S4464"       => "D11S4464",
    "D11S4463"       => "D11S4463",
    "D11S2367"       => "D11S2367",
    "D12S374"        => "D12S374",
    "D12S391"        => "D12S391",
    "D12S1057"       => "D12S1057",
    "D12S2080"       => "D12S2080",
    "D12S1301"       => "D12S1301",
    "D12S1056"       => "D12S1056",
    "D12S1072"       => "D12S1072",
    "D12S375"        => "D12S375",
    "D12S1297"       => "D12S1297",
    "D12S1064"       => "D12S1064",
    "D12S1300"       => "D12S1300",
    "D12S1023"       => "D12S1023",
    "D12S395"        => "D12S395",
    "D12S2078"       => "D12S2078",
    "D13S1493"       => "D13S1493",
    "D13S325"        => "D13S325",
    "D13S1492"       => "D13S1492",
    "D13S801"        => "D13S801",
    "D13S800"        => "D13S800",
    "D13S792"        => "D13S792",
    "D13S317"        => "D13S317",
    "D13S790"        => "D13S790",
    "D13S793"        => "D13S793",
    "D13S796"        => "D13S796",
    "D14S742"        => "D14S742",
    "D14S1280"       => "D14S1280",
    "D14S608"        => "D14S608",
    "D14S121"        => "D14S121",
    "D14S741"        => "D14S741",
    "D14S748"        => "D14S748",
    "D14S747"        => "D14S747",
    "D14S592"        => "D14S592",
    "D14S588"        => "D14S588",
    "D14S126"        => "D14S126",
    "D14S617"        => "D14S617",
    "D14S1434"       => "D14S1434",
    "D14S1426"       => "D14S1426",
    "D15S1513"       => "D15S1513",
    "D15S822"        => "D15S822",
    "D15S1232"       => "D15S1232",
    "D15S659"        => "D15S659",
    "D15GATA153F11"  => "GATA153F11",
    "D15S652"        => "D15S652",
    "D15S816"        => "D15S816",
    "D15S1514"       => "D15S1514",
    "D15S642"        => "D15S642",
    "D16S2622"       => "D16S2622",
    "D16S2619"       => "D16S2619",
    "D16S769"        => "D16S769",
    "D16S3253"       => "D16S3253",
    "D16S2620"       => "D16S2620",
    "D16S752"        => "D16S752",
    "D16S2624"       => "D16S2624",
    "D16S2621"       => "D16S2621",
    "D17S1303"       => "D17S1303",
    "D17AC001348A"   => "AC001348A",
    "D17S2196"       => "D17S2196",
    "D17S1294"       => "D17S1294",
    "D17S1299"       => "D17S1299",
    "D17S1290"       => "D17S1290",
    "D17S2193"       => "D17S2193",
    "D17S2182"       => "D17S2182",
    "D17S1301"       => "D17S1301",
    "D18S843"        => "D18S843",
    "D18S869"        => "D18S869",
    "D18S877"        => "D18S877",
    "D18S847"        => "D18S847",
    "D18S536"        => "D18S536",
    "D18S535"        => "D18S535",
    "D18S978"        => "D18S978",
    "D18S972"        => "D18S972",
    "D18S851"        => "D18S851",
    "D18S51"         => "D18S51",
    "D18S1367"       => "D18S1367",
    "D18S1358"       => "D18S1358",
    "D18S1371"       => "D18S1371",
    "D19S1165"       => "D19S1165",
    "D19S1036"       => "D19S1036",
    "D19S719"        => "D19S719",
    "D2TPOX"         => "TPOX",
    "D2S1360"        => "D2S1360",
    "D2S405"         => "D2S405",
    "D2S441"         => "D2S441",
    "D2S1394"        => "D2S1394",
    "D2S1387"        => "D2S1387",
    "D2S2970"        => "D2S2970",
    "D2S1399"        => "D2S1399",
    "D2S1379"        => "D2S1379",
    "D2S1776"        => "D2S1776",
    "D2S434"         => "D2S434",
    "D2S1338"        => "D2S1338",
    "D2S424"         => "D2S424",
    "D2S1363"        => "D2S1363",
    "D2S427"         => "D2S427",
    "D2S2968"        => "D2S2968",
    "D20S473"        => "D20S473",
    "D20S482"        => "D20S482",
    "D20S603"        => "D20S603",
    "D20S604"        => "D20S604",
    "D20S161"        => "D20S161",
    "D20S1145"       => "D20S1145",
    "D20S607"        => "D20S607",
    "D20S481"        => "D20S481",
    "D20S480"        => "D20S480",
    "D20S468"        => "D20S468",
    "D20S469"        => "D20S469",
    "D20S430"        => "D20S430",
    "D21S1432"       => "D21S1432",
    "D21S1437"       => "D21S1437",
    "D21S1409"       => "D21S1409",
    "D21S226"        => "D21S226",
    "D21S1413"       => "D21S1413",
    "D21S1446"       => "D21S1446",
    "D22-GATA198B05" => "D22-GATA198B05",
    "D22S533"        => "D22S533",
    "D22S691"        => "D22S691",
    "D22S1265"       => "D22S1265",
    "D22S692"        => "D22S692",
    "D22S1045"       => "D22S1045",
    "D22S417"        => "D22S417",
    "D22S444"        => "D22S444",
    "D3S3050"        => "D3S3050",
    "D3S2431"        => "D3S2431",
    "D3S4547"        => "D3S4547",
    "D3S2432"        => "D3S2432",
    "D3S1768"        => "D3S1768",
    "D3S2452"        => "D3S2452",
    "D3S1766"        => "D3S1766",
    "D3S2454"        => "D3S2454",
    "D3S2388"        => "D3S2388",
    "D3S4529"        => "D3S4529",
    "D3S2459"        => "D3S2459",
    "D3S3045"        => "D3S3045",
    "D3S2460"        => "D3S2460",
    "D3S1763"        => "D3S1763",
    "D3S3053"        => "D3S3053",
    "D3S3041"        => "D3S3041",
    "D3S2418"        => "D3S2418",
    "D4S2397"        => "D4S2397",
    "D4S2408"        => "D4S2408",
    "D4S2632"        => "D4S2632",
    "D4S1627"        => "D4S1627",
    "D4S3251"        => "D4S3251",
    "D4S3254"        => "D4S3254",
    "D4S3248"        => "D4S3248",
    "D4S2404"        => "D4S2404",
    "D4S2364"        => "D4S2364",
    "D4S1628"        => "D4S1628",
    "D4S1647"        => "D4S1647",
    "D4S2634"        => "D4S2634",
    "D4S3250"        => "D4S3250",
    "D4S1644"        => "D4S1644",
    "D4FGA"          => "FGA",
    "D4S1629"        => "D4S1629",
    "D4S2368"        => "D4S2368",
    "D4S2417"        => "D4S2417",
    "D4S2390"        => "D4S2390",
    "D5S807"         => "D5S807",
    "D5S2856"        => "D5S2856",
    "D5S2507"        => "D5S2507",
    "D5S2500"        => "D5S2500",
    "D5S806"         => "D5S806",
    "D5S1459"        => "D5S1459",
    "D5S2499"        => "D5S2499",
    "D5S2501"        => "D5S2501",
    "D5S1484"        => "D5S1484",
    "D5S818"         => "D5S818",
    "D5S816"         => "D5S816",
    "D5S1480"        => "D5S1480",
    "D5CSF1PO"       => "CSF1PO",
    "D5S820"         => "D5S820",
    "D5S1471"        => "D5S1471",
    "D5S1456"        => "D5S1456",
    "D6S1266"        => "D6S1266",
    "D6S2439"        => "D6S2439",
    "D6S1281"        => "D6S1281",
    "D6S1960"        => "D6S1960",
    "D6S1275"        => "D6S1275",
    "D6S1031"        => "D6S1031",
    "D6S1043"        => "D6S1043",
    "D6S1021"        => "D6S1021",
    "D6S474"         => "D6S474",
    "D6S1040"        => "D6S1040",
    "D6S2409"        => "D6S2409",
    "D6S1009"        => "D6S1009",
    "D6S2436"        => "D6S2436",
    "D6S1035"        => "D6S1035",
    "D6S1277"        => "D6S1277",
    "D7S3051"        => "D7S3051",
    "D7S3048"        => "D7S3048",
    "D7S1821"        => "D7S1821",
    "D7S817"         => "D7S817",
    "D7S3053"        => "D7S3053",
    "D7S1818"        => "D7S1818",
    "D7S3069"        => "D7S3069",
    "D7S820"         => "D7S820",
    "D7S1820"        => "D7S1820",
    "D7S1817"        => "D7S1817",
    "D7S3052"        => "D7S3052",
    "D7S1824"        => "D7S1824",
    "D7S3070"        => "D7S3070",
    "D8S1458"        => "D8S1458",
    "D8S1477"        => "D8S1477",
    "D8S1104"        => "D8S1104",
    "D8S593"         => "D8S593",
    "D8S2332"        => "D8S2332",
    "D8S2324"        => "D8S2324",
    "D8S1105"        => "D8S1105",
    "D8S1119"        => "D8S1119",
    "D8GAAT1A4"      => "GAAT1A4",
    "D8S1471"        => "D8S1471",
    "D8S1179"        => "D8S1179",
    "D8S1128"        => "D8S1128",
    "D8S1100"        => "D8S1100",
    "D9S2156"        => "D9S2156",
    "D9S1121"        => "D9S1121",
    "D9S2154"        => "D9S2154",
    "D9S304"         => "D9S304",
    "D9S2148"        => "D9S2148",
    "D9S1122"        => "D9S1122",
    "D9S253"         => "D9S253",
    "D9S2145"        => "D9S2145",
    "DXS9902"        => "DXS9902",
    "DXS10075"       => "DXS10075",
    "DXS6803"        => "DXS6803",
    "DXS9898"        => "DXS9898",
    "DXS7133"        => "DXS7133",
    "DXS7130"        => "DXS7130",
    "DXGATA165B12"   => "GATA165B12",
    "DXS7423"        => "DXS7423",
    "DYS393"         => "DYS393",
    "DYS570"         => "DYS570",
    "DYS576"         => "DYS576",
    "DYS443"         => "DYS443",
    "DYS391"         => "DYS391",
    "DYS643"         => "DYS643",
    "DYS513"         => "DYS513",
    "DYS533"         => "DYS533",
    "DYS461"         => "DYS461",
    "DYS460"         => "DYS460",
    "DYS445"         => "DYS445",
    "D1S552"         => "D1S552",
    "D1S2134"        => "D1S2134",
    "D1S3467"        => "D1S3467",
    "D1S534"         => "D1S534",
    "D1S1165"        => "D1S1165",
    "D1S1171"        => "D1S1171",
    "D1S1667"        => "D1S1667",
    "D1S517"         => "D1S517",
    "D1S1609"        => "D1S1609",
    "D10S1430"       => "D10S1430",
    "D11S2368"       => "D11S2368",
    "D11S2363"       => "D11S2363",
    "D11S1998"       => "D11S1998",
    "D12S1030"       => "D12S1030",
    "D13S1824"       => "D13S1824",
    "D14S1432"       => "D14S1432",
    "D14S125"        => "D14S125",
    "D15S817"        => "D15S817",
    "D15S643"        => "D15S643",
    "D15S1507"       => "D15S1507",
    "D15S1515"       => "D15S1515",
    "D16S771"        => "D16S771",
    "D16S3393"       => "D16S3393",
    "D16S2625"       => "D16S2625",
    "D17GATA158H04"  => "GATA158H04",
    "D17S974"        => "D17S974",
    "D17S1535"       => "D17S1535",
    "D18S1370"       => "D18S1370",
    "D18S976"        => "D18S976",
    "D18S973"        => "D18S973",
    "D18S542"        => "D18S542",
    "D18S548"        => "D18S548",
    "D18S1364"       => "D18S1364",
    "D18S870"        => "D18S870",
    "D19S400"        => "D19S400",
    "D2S274"         => "D2S274",
    "D2S436"         => "D2S436",
    "D2S410"         => "D2S410",
    "D2S1353"        => "D2S1353",
    "D2S426"         => "D2S426",
    "D20S162"        => "D20S162",
    "D20S1085"       => "D20S1085",
    "D20S1082"       => "D20S1082",
    "D21S1435"       => "D21S1435",
    "D21S1442"       => "D21S1442",
    "D22S534"        => "D22S534",
    "D3S1358"        => "D3S1358",
    "D3S1764"        => "D3S1764",
    "D3S1744"        => "D3S1744",
    "D4S2366"        => "D4S2366",
    "D5S2488"        => "D5S2488",
    "D5S1486"        => "D5S1486",
    "D5S2845"        => "D5S2845",
    "D5S1470"        => "D5S1470",
    "D5S1474"        => "D5S1474",
    "D6S477"         => "D6S477",
    "D6S1053"        => "D6S1053",
    "D6S1052"        => "D6S1052",
    "D6G15833"       => "G15833",
    "D7S1813"        => "D7S1813",
    "D7S1799"        => "D7S1799",
    "D7S1823"        => "D7S1823",
    "D8S1145"        => "D8S1145",
    "D8S1116"        => "D8S1116",
    "D8S1132"        => "D8S1132",
    "D8S592"         => "D8S592",
    "D9S921"         => "D9S921",
    "D9S319"         => "D9S319",
    "D9S1118"        => "D9S1118",
    "D9S922"         => "D9S922",
    "D9S2128"        => "D9S2128",
    "D9S2157"        => "D9S2157",
    "DXS6810"        => "DXS6810",
    "DXS7132"        => "DXS7132",
    "DYS522"         => "DYS522",
    "DYS635"         => "DYS635",
    "DYS439"         => "DYS439",
    "DYS641"         => "DYS641",
    "D12vWA"         => "vWA",
    "D17S968"        => "D17S968",
    "D2S2952"        => "D2S2952",
    "D2S437"         => "D2S437",
    "D21PentaD"      => "PentaD",
    "D22S686"        => "D22S686",
    "D22S685"        => "D22S685",
    "D6S1279"        => "D6S1279",
    "D6S1017"        => "D6S1017",
    "DXS6807"        => "DXS6807",
    "DXS6789"        => "DXS6789",
    "DXHPRTB"        => "HPRTB",
);
my %len1 = (
    "D1S1646"        => 7142469,
    "D1GATA113"      => 7442868,
    "D1S1597"        => 13784259,
    "D1S3669"        => 17783753,
    "D1S1676"        => 25400954,
    "D1S1598"        => 40342186,
    "D1S3734"        => 59730373,
    "D1S1162"        => 69446700,
    "D1S3733"        => 78919667,
    "D1S551"         => 82895354,
    "D1S1588"        => 92214251,
    "D1S1631"        => 105660667,
    "GATA133A08"     => 106281527,
    "D1S1600"        => 157786564,
    "D1S1653"        => 157932788,
    "D1S1679"        => 162361942,
    "D1S1677"        => 163559814,
    "D1S1589"        => 174261150,
    "D1S518"         => 187550387,
    "D1S2141"        => 215195419,
    "D1S549"         => 219643696,
    "D1S1644"        => 226512634,
    "D1S1656"        => 230905351,
    "D10S1435"       => 2243322,
    "D10S2474"       => 19437987,
    "D10S2481"       => 26334283,
    "D10S1426"       => 30495820,
    "D10S1208"       => 35257713,
    "D10S1221"       => 57529912,
    "D10S1428"       => 66817505,
    "D10S1432"       => 74659444,
    "D10S1427"       => 85847772,
    "D10S1239"       => 103196378,
    "D10S1246"       => 110951376,
    "D10S1425"       => 119340223,
    "D10S1230"       => 122742715,
    "D10S2322"       => 126159210,
    "D10S1248"       => 131092492,
    "TH01"           => 2192297,
    "D11S2362"       => 4912189,
    "D11S1997"       => 6358173,
    "D11S4465"       => 10578245,
    "D11S1999"       => 10720012,
    "D11S1981"       => 17086227,
    "D11S2364"       => 26486807,
    "D11S1392"       => 34640119,
    "D11S1393"       => 43994957,
    "D11S4960"       => 79965538,
    "D11S1367"       => 88707516,
    "D11S4952"       => 90818331,
    "D11S4951"       => 104624644,
    "D11S2000"       => 105558837,
    "D11S4464"       => 123626758,
    "D11S4463"       => 130872399,
    "D11S2367"       => 131538113,
    "D12S374"        => 5966936,
    "D12S391"        => 12449940,
    "D12S1057"       => 24677259,
    "D12S2080"       => 33414512,
    "D12S1301"       => 44062671,
    "D12S1056"       => 60546052,
    "D12S1072"       => 60557018,
    "D12S375"        => 68944860,
    "D12S1297"       => 81425261,
    "D12S1064"       => 90823342,
    "D12S1300"       => 98500964,
    "D12S1023"       => 115471391,
    "D12S395"        => 120188532,
    "D12S2078"       => 127961191,
    "D13S1493"       => 34009011,
    "D13S325"        => 43173424,
    "D13S1492"       => 55705769,
    "D13S801"        => 62561663,
    "D13S800"        => 73874806,
    "D13S792"        => 75152447,
    "D13S317"        => 82722142,
    "D13S790"        => 84435361,
    "D13S793"        => 97951869,
    "D13S796"        => 107889001,
    "D14S742"        => 22201192,
    "D14S1280"       => 26655943,
    "D14S608"        => 28849472,
    "D14S121"        => 32728343,
    "D14S741"        => 33753953,
    "D14S748"        => 48081398,
    "D14S747"        => 54567702,
    "D14S592"        => 61396897,
    "D14S588"        => 70220301,
    "D14S126"        => 88007663,
    "D14S617"        => 92202801,
    "D14S1434"       => 95308391,
    "D14S1426"       => 100619584,
    "D15S1513"       => 26181607,
    "D15S822"        => 27390739,
    "D15S1232"       => 34982613,
    "D15S659"        => 46374096,
    "GATA153F11"     => 57434487,
    "D15S652"        => 92517458,
    "D15S816"        => 95019804,
    "D15S1514"       => 95554051,
    "D15S642"        => 102334885,
    "D16S2622"       => 3709735,
    "D16S2619"       => 13742541,
    "D16S769"        => 26158809,
    "D16S3253"       => 54786682,
    "D16S2620"       => 62113528,
    "D16S752"        => 71335210,
    "D16S2624"       => 71735156,
    "D16S2621"       => 87973538,
    "D17S1303"       => 10859385,
    "AC001348A"      => 14615579,
    "D17S2196"       => 17264494,
    "D17S1294"       => 28382326,
    "D17S1299"       => 38994428,
    "D17S1290"       => 56331482,
    "D17S2193"       => 66547808,
    "D17S2182"       => 67139958,
    "D17S1301"       => 72680975,
    "D18S843"        => 8613793,
    "D18S869"        => 20083612,
    "D18S877"        => 26725187,
    "D18S847"        => 27703369,
    "D18S536"        => 31588317,
    "D18S535"        => 38148820,
    "D18S978"        => 38338178,
    "D18S972"        => 41325718,
    "D18S851"        => 50107549,
    "D18S51"         => 60948896,
    "D18S1367"       => 64552252,
    "D18S1358"       => 70220687,
    "D18S1371"       => 73110768,
    "D19S1165"       => 12294354,
    "D19S1036"       => 23652947,
    "D19S719"        => 33913976,
    "TPOX"           => 1493374,
    "D2S1360"        => 17491973,
    "D2S405"         => 29476668,
    "D2S441"         => 68239046,
    "D2S1394"        => 73139250,
    "D2S1387"        => 85075440,
    "D2S2970"        => 118948531,
    "D2S1399"        => 148210132,
    "D2S1379"        => 167871914,
    "D2S1776"        => 169645391,
    "D2S434"         => 218576633,
    "D2S1338"        => 218879592,
    "D2S424"         => 221348570,
    "D2S1363"        => 227029669,
    "D2S427"         => 232206343,
    "D2S2968"        => 238078497,
    "D20S473"        => 3465552,
    "D20S482"        => 4506324,
    "D20S603"        => 6701183,
    "D20S604"        => 12584368,
    "D20S161"        => 16622124,
    "D20S1145"       => 21612312,
    "D20S607"        => 38796878,
    "D20S481"        => 43768362,
    "D20S480"        => 51857244,
    "D20S468"        => 53459344,
    "D20S469"        => 53639014,
    "D20S430"        => 56150074,
    "D21S1432"       => 17343466,
    "D21S1437"       => 21646862,
    "D21S1409"       => 24348712,
    "D21S226"        => 31341665,
    "D21S1413"       => 33848167,
    "D21S1446"       => 48037672,
    "D22-GATA198B05" => 17650676,
    "D22S533"        => 25849186,
    "D22S691"        => 34875762,
    "D22S1265"       => 35389948,
    "D22S692"        => 37125698,
    "D22S1045"       => 37536297,
    "D22S417"        => 43104542,
    "D22S444"        => 45961559,
    "D3S3050"        => 3296553,
    "D3S2431"        => 16227236,
    "D3S4547"        => 17952395,
    "D3S2432"        => 32165275,
    "D3S1768"        => 34624387,
    "D3S2452"        => 58698741,
    "D3S1766"        => 58981683,
    "D3S2454"        => 70373286,
    "D3S2388"        => 83164179,
    "D3S4529"        => 85852630,
    "D3S2459"        => 102175377,
    "D3S3045"        => 106990007,
    "D3S2460"        => 117402401,
    "D3S1763"        => 167239748,
    "D3S3053"        => 171750928,
    "D3S3041"        => 176480266,
    "D3S2418"        => 192317029,
    "D4S2397"        => 27257912,
    "D4S2408"        => 31304393,
    "D4S2632"        => 35704139,
    "D4S1627"        => 44178853,
    "D4S3251"        => 44549317,
    "D4S3254"        => 55437124,
    "D4S3248"        => 60021583,
    "D4S2404"        => 93499860,
    "D4S2364"        => 93517341,
    "D4S1628"        => 98286470,
    "D4S1647"        => 99435006,
    "D4S2634"        => 100077943,
    "D4S3250"        => 123917704,
    "D4S1644"        => 141751542,
    "FGA"            => 155508884,
    "D4S1629"        => 158336832,
    "D4S2368"        => 168716345,
    "D4S2417"        => 180168606,
    "D4S2390"        => 189752990,
    "D5S807"         => 9207961,
    "D5S2856"        => 41033865,
    "D5S2507"        => 56837655,
    "D5S2500"        => 58697257,
    "D5S806"         => 81493510,
    "D5S1459"        => 85170781,
    "D5S2499"        => 91436252,
    "D5S2501"        => 110036439,
    "D5S1484"        => 114392930,
    "D5S818"         => 123111227,
    "D5S816"         => 135301662,
    "D5S1480"        => 144143807,
    "CSF1PO"         => 149455879,
    "D5S820"         => 156122483,
    "D5S1471"        => 166876503,
    "D5S1456"        => 169032564,
    "D6S1266"        => 18958695,
    "D6S2439"        => 24306710,
    "D6S1281"        => 25297109,
    "D6S1960"        => 53504623,
    "D6S1275"        => 67241974,
    "D6S1031"        => 77461369,
    "D6S1043"        => 92449912,
    "D6S1021"        => 104673934,
    "D6S474"         => 112879140,
    "D6S1040"        => 130985810,
    "D6S2409"        => 134647505,
    "D6S1009"        => 137302205,
    "D6S2436"        => 154136278,
    "D6S1035"        => 160027163,
    "D6S1277"        => 164297790,
    "D7S3051"        => 18284606,
    "D7S3048"        => 21266713,
    "D7S1821"        => 25124749,
    "D7S817"         => 32136391,
    "D7S3053"        => 39169222,
    "D7S1818"        => 49388970,
    "D7S3069"        => 52281896,
    "D7S820"         => 83789528,
    "D7S1820"        => 93353821,
    "D7S1817"        => 109238656,
    "D7S3052"        => 109381528,
    "D7S1824"        => 140012631,
    "D7S3070"        => 151567183,
    "D8S1458"        => 3433758,
    "D8S1477"        => 32067221,
    "D8S1104"        => 40643930,
    "D8S593"         => 55725310,
    "D8S2332"        => 56130286,
    "D8S2324"        => 74254423,
    "D8S1105"        => 78848732,
    "D8S1119"        => 87172065,
    "GAAT1A4"        => 99189775,
    "D8S1471"        => 113705131,
    "D8S1179"        => 125907083,
    "D8S1128"        => 128595190,
    "D8S1100"        => 137086646,
    "D9S2156"        => 7929068,
    "D9S1121"        => 25403123,
    "D9S2154"        => 26171266,
    "D9S304"         => 32324050,
    "D9S2148"        => 38295718,
    "D9S1122"        => 79688729,
    "D9S253"         => 91866364,
    "D9S2145"        => 121416697,
    "DXS9902"        => 15323694,
    "DXS10075"       => 66998216,
    "DXS6803"        => 86431194,
    "DXS9898"        => 87796443,
    "DXS7133"        => 109041562,
    "DXS7130"        => 118200189,
    "GATA165B12"     => 120877995,
    "DXS7423"        => 149710955,
    "DYS393"         => 3131140,
    "DYS570"         => 6861224,
    "DYS576"         => 7053343,
    "DYS443"         => 7508352,
    "DYS391"         => 14102794,
    "DYS643"         => 17425996,
    "DYS513"         => 17441753,
    "DYS533"         => 18393220,
    "DYS461"         => 21050687,
    "DYS460"         => 21050822,
    "DYS445"         => 22092569,
    "D1S552"         => 19267052,
    "D1S2134"        => 48281421,
    "D1S3467"        => 64406141,
    "D1S534"         => 119678294,
    "D1S1165"        => 171801607,
    "D1S1171"        => 201917438,
    "D1S1667"        => 212770755,
    "D1S517"         => 239360999,
    "D1S1609"        => 244065795,
    "D10S1430"       => 12737006,
    "D11S2368"       => 19281140,
    "D11S2363"       => 59236092,
    "D11S1998"       => 117697710,
    "D12S1030"       => 102924961,
    "D13S1824"       => 67256481,
    "D14S1432"       => 38581115,
    "D14S125"        => 66378061,
    "D15S817"        => 24604275,
    "D15S643"        => 59713826,
    "D15S1507"       => 65340064,
    "D15S1515"       => 98333692,
    "D16S771"        => 54509088,
    "D16S3393"       => 64565811,
    "D16S2625"       => 84717769,
    "GATA158H04"     => 6333009,
    "D17S974"        => 10518741,
    "D17S1535"       => 72561459,
    "D18S1370"       => 3157573,
    "D18S976"        => 5248971,
    "D18S973"        => 5781237,
    "D18S542"        => 11492793,
    "D18S548"        => 41800687,
    "D18S1364"       => 63400221,
    "D18S870"        => 71012901,
    "D19S400"        => 41527566,
    "D2S274"         => 106337870,
    "D2S436"         => 107243258,
    "D2S410"         => 116240958,
    "D2S1353"        => 159558950,
    "D2S426"         => 190353787,
    "D20S162"        => 10037114,
    "D20S1085"       => 52681643,
    "D20S1082"       => 53865893,
    "D21S1435"       => 27848895,
    "D21S1442"       => 28818554,
    "D22S534"        => 40965669,
    "D3S1358"        => 45582230,
    "D3S1764"        => 139188501,
    "D3S1744"        => 147092547,
    "D4S2366"        => 6484813,
    "D5S2488"        => 127452,
    "D5S1486"        => 10139773,
    "D5S2845"        => 22390681,
    "D5S1470"        => 32492378,
    "D5S1474"        => 61309971,
    "D6S477"         => 6140623,
    "D6S1053"        => 64590331,
    "D6S1052"        => 81486064,
    "G15833"         => 147967126,
    "D7S1813"        => 91552857,
    "D7S1799"        => 104195076,
    "D7S1823"        => 154567812,
    "D8S1145"        => 18352569,
    "D8S1116"        => 21430423,
    "D8S1132"        => 107328917,
    "D8S592"         => 118456187,
    "D9S921"         => 10509468,
    "D9S319"         => 29559736,
    "D9S1118"        => 31925328,
    "D9S922"         => 82968377,
    "D9S2128"        => 113526829,
    "D9S2157"        => 136035548,
    "DXS6810"        => 42918710,
    "DXS7132"        => 64655503,
    "DYS522"         => 7415607,
    "DYS635"         => 14379499,
    "DYS439"         => 14515304,
    "DYS641"         => 16134286,
    "vWA"            => 6093129,
    "D17S968"        => 72604254,
    "D2S2952"        => 8078070,
    "D2S437"         => 117591587,
    "PentaD"         => 45056081,
    "D22S686"        => 23068535,
    "D22S685"        => 34595617,
    "D6S1279"        => 12184205,
    "D6S1017"        => 41677254,
    "DXS6807"        => 4743406,
    "DXS6789"        => 95449439,
    "HPRTB"          => 133615521,
);

#my $header = <IN>;
#$header =~s/\n//;
$header = "chr\tpos\t\tF\tM\tS\tMMMM\tMMMP\tMMPP\tPPPP\tPPPM\n";
print "$header";
while (<IN>) {
    chomp;
    $line = $_;

    if ( substr( $line, 0, 2 ) ne "##" ) {
        $line_count++;
        my @line = split /\t/, $line;
        if ( $line[0] =~ /^\D[0-9]+/ ) {
            $line[0] =~ /^\D[0-9]+/;
            $chr = $&;
        }
        elsif ( $line[0] =~ 'DX' ) {
            $chr = 'DX';
        }

        #print"$chr\n";
        #$hash4{$chr}++;
        push @line, 0;

        #print"dad\tmom\tson\tson_from_dm\tson_from_dad\tson_from_mom\tson_off_dm\n";
        my @mom = split /\//, $line[$mom];
        my @son = split /\//, $line[$son];
        my @dad = split /\//, $line[$dad];
        if ( $line_count >= 1 ) {

            #my @mom_var=split/\,/,$mom[3];
            foreach $each_mom (@mom) {
                if ( $line[$mom] eq 'NA' or $line[$mom] eq "" or $line[$mom] eq 'F' ) {
                    $sum_mom = 0;
                }
                else {
                    my @mom_var = split /\|/, $each_mom;
                    if ( $mom_var[0] =~ /[0-9]\(/ ) {
                        @sum_type = split( /\D+/, $mom_var[0] );
                        shift @sum_type;
                        $mom_var3 = join( "\+", @sum_type );
                        $mom_var_type = $mom_var3;
                        $mom_var_type =~ s/\([A-Z]+\)//g;
                        push @mom_var3, $mom_var_type;
                        push @mom_var1, $mom_var3;
                        push @mom_var2, $mom_var[2];
                    }
                    else {
                        $mom_var_type = $mom_var[0];
                        $mom_var_type =~ s/\([A-Z]+\)//g;
                        push @mom_var3, $mom_var_type;
                        push @mom_var1, $mom_var[0];
                        push @mom_var2, $mom_var[2];
                    }
                    $hashmom{ $line[ $mom - 1 ] . '_' . $mom_var[0] } = $mom_var[1];
                    $sum_mom += $mom_var[1];
                }
            }
            foreach $each_son (@son) {
                if ( $line[$son] eq 'NA' or $line[$son] eq "" or $line[$son] eq 'F' ) {
                    $sum_son = 0;
                }
                else {
                    my @son_var = split /\|/, $each_son;
                    if ( $son_var[0] =~ /[0-9]\(/ ) {
                        @sum_type = split( /\D+/, $son_var[0] );
                        shift @sum_type;
                        $son_var3 = join( "\+", @sum_type );
                        $son_var_type = $son_var3;
                        $son_var_type =~ s/\([A-Z]+\)//g;
                        push @son_var3, $son_var_type;
                        push @son_var1, $son_var3;
                        push @son_var2, $son_var[2];
                    }
                    else {
                        $son_var_type = $son_var[0];
                        $son_var_type =~ s/\([A-Z]+\)//g;
                        push @son_var3, $son_var_type;
                        push @son_var1, $son_var[0];
                        push @son_var2, $son_var[2];
                    }
                    $hashson{ $line[ $son - 1 ] . '_' . $son_var[0] } = $son_var[1];
                    $hashson1{ $son_var[0] } = $son_var[2];
                    $sum_son += $son_var[1];
                }
            }
            shift @son_var1;
            shift @son_var3;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ M2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P1 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . M2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P1 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . M2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P1 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . M2 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P1 . '_' . $son_var1[3] } = 1;
            $hash{ P2 . '_' . $son_var1[0] . '|' . P2 . '_' . $son_var1[1] . '|' . P2 . '_' . $son_var1[2] . '|' . P2 . '_' . $son_var1[3] } = 1;

            @son_var1 = "";
            foreach $each_dad (@dad) {
                if ( $line[$dad] eq 'NA' or $line[$dad] eq "" or $line[$dad] eq 'F' ) {
                    $sum_dad = 0;
                }
                else {
                    my @dad_var = split /\|/, $each_dad;
                    if ( $dad_var[0] =~ /[0-9]\(/ ) {
                        @sum_type = split( /\D+/, $dad_var[0] );
                        shift @sum_type;
                        $dad_var3 = join( "\+", @sum_type );
                        $dad_var_type = $dad_var3;
                        $dad_var_type =~ s/\([A-Z]+\)//g;
                        push @dad_var3, $dad_var_type;
                        push @dad_var1, $dad_var3;
                        push @dad_var2, $dad_var[2];
                    }
                    else {
                        $dad_var_type = $dad_var[0];
                        $dad_var_type =~ s/\([A-Z]+\)//g;
                        push @dad_var3, $dad_var_type;
                        push @dad_var1, $dad_var[0];
                        push @dad_var2, $dad_var[2];
                    }
                    $hashdad{ $line[ $dad - 1 ] . '_' . $dad_var[0] } = $dad_var[1];

                    #print"$line[$dad-1]".'_'."$dad_var[0]\n";
                    $hashdad1{ $dad_var[0] } = $each_dad;
                    $sum_dad += $dad_var[1];
                }
            }
            shift @mom_var1;
            shift @mom_var3;
            shift @dad_var1;
            shift @dad_var3;
            my @mom_dad = ( M1 . '_' . $mom_var1[0], M2 . '_' . $mom_var1[1], P1 . '_' . $dad_var1[0], P2 . '_' . $dad_var1[1] );

            #print"@mom_dad\n";
            @mom_var1 = "";
            @dad_var1 = "";
            foreach $mom_dad1 (@mom_dad) {
                foreach $mom_dad2 (@mom_dad) {
                    foreach $mom_dad3 (@mom_dad) {
                        foreach $mom_dad4 (@mom_dad) {
                            $hash1{ $mom_dad1 . '|' . $mom_dad2 . '|' . $mom_dad3 . '|' . $mom_dad4 } = 1;

                            #print $mom_dad1.'|'.$mom_dad2.'|'.$mom_dad3."\n";
                        }
                    }
                }
            }
            if ( $sum_dad > 50 and $sum_mom >= 50 and $sum_son > 50 ) {
                $hash4{$chr}++;
                foreach ( keys %hash ) {
                    if ( exists $hash1{$_} ) {

                        #print $_."\n";
                        my @line1 = split( /\|/, $_ );
                        foreach $line1 (@line1) {
                            my @line2 = split( /\_/, $line1 );
                            push @line3, $line2[0];
                        }
                        shift @line3;
                        my $line3 = join( "", @line3 );
                        $line3 =~ s/\d+//g;

                        #print $line3."\n";
                        $hash3{$line3}++;
                        @line3 = "";
                    }
                }
                $ran = $chr;
                $ran =~ s/D/Chr/;
                $son_var3_type = join( "\/", @son_var3 );
                $mom_var1_type = join( "\/", @mom_var3 );
                $dad_var1_type = join( "\/", @dad_var3 );
                $chr_result= "$ran\t$len{$line[0]}\t$len1{$len{$line[0]}}\t$dad_var1_type\t$mom_var1_type\t$son_var3_type\t";
                if ( exists( $hash3{MMMM} ) ) {
                    #print "YES\t";
                    push @result_p,"YES";
                    $hash5{ $chr . '_' . MMMM }++;
                }
                if ( !exists( $hash3{MMMM} ) ) {
                    #print "NO\t";
                    push @result_p,"NO";
                }
                if ( exists $hash3{MMMP} or exists $hash3{MMPM} or exists $hash3{MPMM} or exists $hash3{PMMM} ) {
                    #print "YES\t";
                    push @result_p,"YES";
                    $hash5{ $chr . '_' . MMMP }++;
                }
                if ( !exists $hash3{MMMP} and !exists $hash3{MMPM} and !exists $hash3{MPMM} and !exists $hash3{PMMM} ) {
                    #print "NO\t";
                    push @result_p,"NO";
                }
                if (   exists $hash3{MMPP}
                    or exists $hash3{MPMP}
                    or exists $hash3{MPPM}
                    or exists $hash3{PMMP}
                    or exists $hash3{PMPM}
                    or exists $hash3{PPMM} )
                {
                    #print "YES\t";
                    push @result_p,"YES";
                    $hash5{ $chr . '_' . MMPP }++;
                }
                if (    !exists $hash3{MMPP}
                    and !exists $hash3{MPMP}
                    and !exists $hash3{MPPM}
                    and !exists $hash3{PMMP}
                    and !exists $hash3{PMPM}
                    and !exists $hash3{PPMM} )
                {
                    #print "NO\t";
                    push @result_p,"NO";
                }
                if ( exists $hash3{PPPP} ) {
                    #print "YES\t";
                    push @result_p,"YES";
                    $hash5{ $chr . '_' . PPPP }++;
                }
                if ( !exists $hash3{PPPP} ) {
                    #print "NO\t";
                    push @result_p,"NO";
                }
                if ( exists $hash3{PPPM} or exists $hash3{PPMP} or exists $hash3{PMPP} or exists $hash3{MPPP} ) {
                    #print "YES\t";
                    push @result_p,"YES";
                    $hash5{ $chr . '_' . PPPM }++;
                }
                if ( !exists $hash3{PPPM} and !exists $hash3{PPMP} and !exists $hash3{PMPP} and !exists $hash3{MPPP} ) {
                    #print "NO\t";
                    push @result_p,"NO";
                }
                shift @result_p;
                $result_p = join( "\t", @result_p );
                if ( $result_p =~ 'YES' ) {
                    $chr_result .= $result_p;
                    @result_p = "";
                }
                if ( $result_p !~ 'YES' ) {
                    $hash4{$chr}--;
                    $chr_result .= $hash4{$chr};
                    @result_p = "";
                }
                
            }
            $sum_dad  = 0;
            $sum_mom  = 0;
            $sum_son  = 0;
            %hash     = "";
            %hash1    = "";
            %hash2    = "";
            %hash3    = "";
            @son_var3 = "";
            @mom_var3 = "";
            @dad_var3 = "";
        }
    }
    if ( $chr_result ne "" ) {
        push @chr_result, $chr_result;
        $chr_result = "";
    }
}

##print haplotype result
foreach $x (
    sort {
             ( split /Chr/, ( split /\t/, $a )[0] )[1] <=> ( split /Chr/, ( split /\t/, $b )[0] )[1]
          or ( split /\t/, $a )[2] <=> ( split /\t/, $b )[2]
    } @chr_result
  )
{
    my @line_hapx = split /\t/, $x;

    #delete $line_hapx[2];
    $line_hap = join( "\t", @line_hapx );
    $line_hap =~ s/\t\t/\t/;
    print "$line_hap\n";
}

$header1 = "chr\tnum\tMMMM\tMMMP\tMMPP\tPPPP\tPPPM\n";
print "$header1";
foreach $chr1 ( sort { ( split /D/, $a )[1] <=> ( split /D/, $b )[1] } keys %hash4 ) {
    if ( $chr1 ne "" and $chr1 ne "DX" ) {
        $chr_2 = $chr1;
        $chr_2 =~ s/D/Chr/;
        print "$chr_2\t$hash4{$chr1}\t";

        #print"$chr1\t$hash4{$chr1}\t";
        $hash_all  += $hash4{$chr1};
        $hash_MMMM += $hash5{ $chr1 . '_' . MMMM };
        $hash_MMMP += $hash5{ $chr1 . '_' . MMMP };
        $hash_MMPP += $hash5{ $chr1 . '_' . MMPP };
        $hash_PPPP += $hash5{ $chr1 . '_' . PPPP };
        $hash_PPPM += $hash5{ $chr1 . '_' . PPPM };
        $rate1 = sprintf( "%.2f", $hash5{ $chr1 . '_' . MMMM } / $hash4{$chr1} ) * 100 . '%';
        $rate2 = sprintf( "%.2f", $hash5{ $chr1 . '_' . MMMP } / $hash4{$chr1} ) * 100 . '%';
        $rate3 = sprintf( "%.2f", $hash5{ $chr1 . '_' . MMPP } / $hash4{$chr1} ) * 100 . '%';
        $rate4 = sprintf( "%.2f", $hash5{ $chr1 . '_' . PPPP } / $hash4{$chr1} ) * 100 . '%';
        $rate5 = sprintf( "%.2f", $hash5{ $chr1 . '_' . PPPM } / $hash4{$chr1} ) * 100 . '%';
        print "$rate1\t$rate2\t$rate3\t$rate4\t$rate5\n";
    }
    if ( $chr1 eq 'DX' ) {
        $rate1 = sprintf( "%.2f", $hash5{ $chr1 . '_' . MMMM } / $hash4{$chr1} ) * 100 . '%';
        $rate2 = sprintf( "%.2f", $hash5{ $chr1 . '_' . MMMP } / $hash4{$chr1} ) * 100 . '%';
        $rate3 = sprintf( "%.2f", $hash5{ $chr1 . '_' . MMPP } / $hash4{$chr1} ) * 100 . '%';
        $rate4 = sprintf( "%.2f", $hash5{ $chr1 . '_' . PPPP } / $hash4{$chr1} ) * 100 . '%';
        $rate5 = sprintf( "%.2f", $hash5{ $chr1 . '_' . PPPM } / $hash4{$chr1} ) * 100 . '%';
        $chrX  = "ChrX\t$hash4{$chr1}\t$rate1\t$rate2\t$rate3\t$rate4\t$rate5\n";
    }
}
$rate_MMMM = sprintf( "%.2f", $hash_MMMM / $hash_all ) * 100 . '%';
$rate_MMMP = sprintf( "%.2f", $hash_MMMP / $hash_all ) * 100 . '%';
$rate_MMPP = sprintf( "%.2f", $hash_MMPP / $hash_all ) * 100 . '%';
$rate_PPPP = sprintf( "%.2f", $hash_PPPP / $hash_all ) * 100 . '%';
$rate_PPPM = sprintf( "%.2f", $hash_PPPM / $hash_all ) * 100 . '%';
print '总计' . "\t$hash_all\t$rate_MMMM\t$rate_MMMP\t$rate_MMPP\t$rate_PPPP\t$rate_PPPM\n$header1$chrX";
