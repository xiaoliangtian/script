#!/usr/bin/perl
#use strict;
#use warnings;

die "Usage: perl $0 fastq fasta\n" unless ( @ARGV == 2 );
open( FILE, "$ARGV[0]" )  or die "Failed to open file $ARGV[0]\n";
open( OUT,  ">$ARGV[1]" ) or die "Failed to open file $ARGV[1]\n";

my %len = (
    "CAAGATCATGCCGCTGCC_TAAGTAGATGGGAGCCAC" => "D1S1646",
    "CCTCTTTGTTGCAGTGAT_TTTTCTCAAAATTTCCTA" => "D1GATA113",
    "GATGGATGGATGGACAGA_GCTCTTCTTTGCCAGGAT" => "D1S552",
    "GAGGTGAACCAAGGGACC_AGAAGGACTGAGACTTAC" => "D1S1598",
    "CCAAGTGACTGAGGGTTG_GATGGCTGGGATAACACA" => "D1S2134",
    "GCTTCCGTAACTACATGA_CATGTATTAGGTTCTCCA" => "D1S3734",
    "GTTTCCTATGTTCCAAGC_CAATTTAGTTATGCGTGC" => "D1S1162",
    "TGTCTTTATCAGTAGTGT_GCCATGGCCCACTTAAGT" => "D1S3733",
    "TGTTGAGGTAACTTTTTG_GGGCAATTAGACATCTAT" => "D1GATA133A08",
    "GATTTGGGCAGCAACTTC_TTTCTTTTGCAGGTAGTT" => "D1S1600",
    "CATGGTACTCAGCAGGGC_AGTACTGCTTGAGGGTTT" => "D1S1679",
    "GTATAGCTACAGTTTTTC_TTGTATTTCTTAGTGTGA" => "D1S1677",
    "ACATATATTTGTGGATGG_TGTGGGCAACTGCATTAG" => "D1S518",
    "TGTGTTGTTATATTCTGG_GGCAGGGGGTGAAAAGAT" => "D1S1667",
    "AATCACTAGGGAACCAAA_GCCTGTGTTGCTCAAGGG" => "D1S1656",
    "GAGCTGTGATCACGCTAC_TTCAGCCTCCTCTTGTTG" => "D1S1171",
    "GTGTTTCAGGGCTGTGAT_CCTTCTGTCCTTGTCAGC" => "D2TPOX",
    "GCCTATTGTGGGATCTTG_TCTGCTCTTGGAGGGTTA" => "D2S2952",
    "TCTAAATGGCATATACAA_GGACTTCTCAGTCTCTAT" => "D2S1360",
    "GGCAGAAGCGTGGCAGTT_ACACAGCCAAACCACAGC" => "D2S405",
    "GGCTGTAACAAGGGCTAC_GGAGCTAAGTGGCTGTGG" => "D2S441",
    "GGTTGATATATTTATCCC_GGCTAGTGATATTTAACA" => "D2S2970",
    "AATATCTACTAAGTACCT_AAACCTACATCCCATAGA" => "D2S1379",
    "TTACCTGTGAGTATGTGT_AGCTACTGAGGAGGCATT" => "D2S1776",
    "CTCCAATGGGTAAGCTCC_AGAGTGAGACCCTGCCTC" => "D2S426",
    "GGATTGCAGGAGGGAAGG_GGATTTGGAAACAGAAAT" => "D2S1338",
    "GCTGTGCCACAGTTGAGT_TTCCTGTTCAGTGCTGTA" => "D2S424",
    "TGTATTTGGAAGCATTTG_TTGCTACTTCACTCCATC" => "D2S1363",
    "CTATGTGTACAGAGATAT_AGACATTATAAAGCAGTA" => "D2S427",
    "CAGGCAGGTAGATAGACA_ACACTACACAAGCATAGT" => "D3S2432",
    "AGAAGAATGTGTTTGGTA_TGCACTGTTTTATCCATC" => "D3S1768",
    "CTCATGAAATCAACAGAG_TATGATTCCCCCACTGCA" => "D3S1358",
    "AAAGTGTATTAGATTAGT_CTTGGCTCCCATGATTGC" => "D3S2452",
    "GCTGATCCTGTGGTTTGT_AACCTATGTCTTTGGCAT" => "D3S2388",
    "CCTCCAGGGAGACAAAAT_ACTTGCCAGACCCCAAAA" => "D3S4529",
    "TTCTTAACTACAGAAGCA_CCAGTTATGAGGACGGTT" => "D3S3045",
    "GTCTGGCCCCATCTCTCT_CGGAAGGAAGTGTGTGTC" => "D3S1744",
    "AAGAGAGGGCTGAACTCA_TGAGGTCTTTGCTCTCAT" => "D3S3053",
    "CCAGACTTCCACAATCAC_AAGAGAAACAGATCAACA" => "D3S3041",
    "CCTGACATTCCTAGGGTG_AGCAAAACAAATATGGCT" => "D4S2366",
    "AATTCAGCAAGTTAAGAA_TCAATTCATCCACTGAAA" => "D4S2408",
    "GAACAGGAATAAGTTGCA_GGCTGTAACCAATCTAGG" => "D4S2632",
    "GCTTCATGTGTGAAGTGC_GCTGTGGGAAGTTGAACA" => "D4S3251",
    "TCTGGGCAAACTCATTTC_TGATGCATGTCAAAATGG" => "D4S2404",
    "AGAATTGTTGTCTGTAGG_GATGTGGGAAGGAAAGTA" => "D4S2364",
    "CCAAAAGTATCTGGCATG_ACTCATGGTAGCCAAATA" => "D4S1628",
    "AATTTCAGGACTAGGGCA_CCCAAAGCTACTATCCCA" => "D4S2634",
    "TGGGTAGGTAGGTAAAGA_AATTGTGTGAGCCAATTC" => "D4S3250",
    "ATGAGGGTCTGTTGGTAG_TGGTCCCTAGTCTGTTGC" => "D4S1644",
    "TTGCCAGCAAAAAAGAAA_AAAATTAGGCATATTTAC" => "D4FGA",
    "GTTGGTTCTGCTTTTTCT_AACAGACAAATGACAAAT" => "D4S1629",
    "GTGACACCATAGGGTAAC_GAGGGTGTACTCCTTGAT" => "D4S2368",
    "CCAAAAGCCTTGATTACA_AGCTGCTTCCCTAAACCT" => "D5S2845",
    "AATCAAATCAAAAGGACA_TTTTAGGTTCTGGGCATG" => "D5S2856",
    "GGGCAACACAGACTCTGT_CCATCTTATTCACTCTCT" => "D5S2500",
    "ATACCATTCATAAAGCCT_GTGCCTAGCCACTGGTAA" => "D5S1474",
    "TGAATCAATTACCCTAAC_CTAAGGCTTCTGTATTAG" => "D5S2499",
    "CATAGCCACAGTTTACAA_GGTGATTTTCCTCTTTGG" => "D5S818",
    "TTTCCTGTGTCAGACCCT_AATGAAGATATTAACAGT" => "D5CSF1PO",
    "AATTGCATAAGCCAACTC_GCTTTAATAATCAGTGTT" => "D5S820",
    "TGTTTGTGGCAGAGTGTG_GAAAGCACCAAACTATAA" => "D5S1471",
    "GGGCTGATGAGGTGAAAT_CTGGGGGATATCTCAAAC" => "D6S477",
    "TGGCAAAACCCCATTTCA_GCCACCTTTGACTTTGGA" => "D6S2439",
    "ATGGATGGGTGGATGCAT_CATCCACCCACCATTATA" => "D6S1017",
    "TCACAGGTTGCTAGACAT_GTAGAGATAATGCAGGCA" => "D6S1960",
    "TGAGTACATTCTAGGCAC_CCAACCTCACTGTATCAT" => "D6S1275",
    "AGCATCACAAGTTAAGTG_ACCTGCAAAGCTCATTGT" => "D6S1052",
    "CATATTGTGAAATTTCTC_GGATGGGTGGATCAATAG" => "D6S1043",
    "AAAGCCTATTTAGTCAGG_GCCAATTCCTCTCATAAA" => "D6S474",
    "GCAGATTATATCTATCCT_GGAATGAGGAATGGGGTA" => "D6S2409",
    "GGACTTTTCAGCCTTCAT_GGGTTGTATTAGTCAGGA" => "D6S2436",
    "TTCACAATGAAACTCATT_CAAAAATCTGATAGATAG" => "D7S3048",
    "TCATAACCATGTAAGCCA_CAATAATGCCTGTATTAG" => "D7S1821",
    "TCCTGGTCCAGGACAAAT_TCTTTATGGCTGACTGTT" => "D7S817",
    "TCTATCTATCTTTTTATA_ACCCAGGATTGTGCTAAC" => "D7S1818",
    "TGGTACTTCTCAGCTTCT_TCTTTTCTGTACATCTGT" => "D7S3069",
    "AATGTTTACTATAGACTA_AAAGGGTATGATAGAACA" => "D7S820",
    "TGTATCAGTCTCAGGATA_TCACACTCTACTTATTCT" => "D7S1820",
    "CCCACAGAGGCAGAACTA_TCAGCCTTCATAATTGCA" => "D7S1799",
    "CTTTGATCAATGCCTCCC_TGTTGATAAAGTGAGACT" => "D7S3052",
    "CAAGGATATCTCTTCTCA_CCATTTCTTCTGCCCCCA" => "D7S3070",
    "ACAATCCAGTAATCTATA_ACAGGCACATTCTCTTTT" => "D8S1145",
    "CCCACATGTGAATTTCTT_CCTCTAATGTAACTTACC" => "D8S1477",
    "TCAGCTATGAGAAAAGTT_TTGACCCTTGTTTGTGTA" => "D8S1104",
    "AAGTATAATATCCTTTTT_GCAAAGCAGTCTTCTGAG" => "D8S2332",
    "GCAATATCAAACCTGGTG_CAAGGACGCCATGACTGT" => "D8S1105",
    "CACTGTGTGTGTCTTCTC_TCTCCAGTGTTTATCATT" => "D8GAAT1A4",
    "AGTGGCTTAATGTATTTG_ATCTCTCTCTCCCTCTCT" => "D8S1132",
    "AGATGATGTTGTTGTTGA_TCCTGTTGGCTAATGTTC" => "D8S592",
    "CACGGCCTGGCAACTTAT_ATTTACCTATCCTGTAGA" => "D8S1179",
    "TGTGTCATTATATGCACA_GTCAAGCTTTGAGCCTAA" => "D9S2156",
    "GCTCCTGTGCCCTTTTGA_GAGAATCTTGTGATGCCA" => "D9S921",
    "TGCTGGGCTTAGAAATAT_CCTATGTTTTCTGATACC" => "D9S1121",
    "AAATACAAAAATCACTGG_TGTAAGTTCTTTGAAATG" => "D9S2154",
    "TTACTAGATGTATTAGCC_CAGCCAAAATAACTGCTT" => "D9S319",
    "ACAGTTTTAAGTAAGGAT_TCTCTCTCTTTCTCCCTA" => "D9S1118",
    "CTACACCCGGACTCCAGT_TGCCCACACACATCTATC" => "D9S304",
    "CACCTGTCTATCCATTCG_CAAGATGGTGCAGGGAGT" => "D9S2148",
    "GCTTATTTGTGGGGGTAT_GCACCCAAAGACACCAAT" => "D9S1122",
    "GTGGTTGAAACACTGAAA_TAAGGCACACACAAGACC" => "D9S2128",
    "CTTCTAAAAAGGAAATAA_TCTCCCCATATCCACAGT" => "D9S2145",
    "TGCTGTGTTTGTTATAAT_CACCTTGGGTCATAGCCA" => "D10S1435",
    "CCTCGTTGGAGTGGACCA_CAAGTCATTCTCCGTCTG" => "D10S1430",
    "AGAGCCTTAAACATATAG_CCTGAGCAACTAAGTGAG" => "D10S2474",
    "TGGCCGATCCTGAAGCAA_GTCATCCTCTTTCATGAC" => "D10S1426",
    "CACCCAAAGTTAACCATG_TCACATGTACCCCATAAA" => "D10S1428",
    "CCAACTTTTGAGTATGGA_CACAATCCAATCACATGG" => "D10S1432",
    "CACCAAATTGGCATTCCT_TTCTTAAGACTACGGACT" => "D10S1246",
    "CACTGTTTTAATTGCTGT_GGAGTTGCGTTACTTGAT" => "D10S1425",
    "CCAATCTGGTCACAAACA_GTCTTGTTATTAAAGGAA" => "D10S1248",
    "GCTTCCGAGTGCAGGTCA_GGCAAAATTCAAAGGGTA" => "D11TH01",
    "GGAACTGGAGTAAACAAG_ACATGGCAGCAGGCATAT" => "D11S1999",
    "CAGATTTCTGCTTTCCCA_CCAGAAAGGGAAGAAGAA" => "D11S1981",
    "ACAATGAGGTGCAAGAAT_ATGGATGGATGAGTTAGA" => "D11S2368",
    "GTGTCCTACAAATAGAAA_CACATATGATGCTATAAG" => "D11S2364",
    "AGAAGGCCTTGAGACATC_TGCCAACTTCAACAAGAC" => "D11S1392",
    "TGCAGATGCTCTGTTCTT_GCAGTATGACTTTGCAAA" => "D11S1393",
    "CCCAGGCTCAAGCCATAA_CCAATTCTTAGGCCAGGC" => "D11S2363",
    "CACACCAGCCAGTTATTA_GGACATGGCCCTTCTTTT" => "D11S4960",
    "TGAAAAACATCTGTTGAG_AAGCATTGTGCTAGGCTC" => "D11S1367",
    "ACCCAGCAAAAACAACTG_CTGTGTCAAAGGGTATAT" => "D11S4951",
    "CCAGGTAATATTTACCCT_GGTGCCTTGCACACAGAG" => "D11S1998",
    "AATACGCAATTCTGGATT_CCATCAGATAATTAAATA" => "D11S4463",
    "CCATCAAGAGAGGAATGG_TGCTGTGAATAGCAGGAT" => "D12S374",
    "AGAGATAGGACAGATGAT_AAGAATAATCAGTATGTG" => "D12vWA",
    "TCCAGAGAGAAAGAATCA_CTCCATATCACTTGAGCT" => "D12S391",
    "TCCATACCCATGAGCCAA_AGAGAGACAGAAGCAGTA" => "D12S1057",
    "TGGGTAGGGCAAGGTATC_GCATAAGAGACTTCCTTG" => "D12S2080",
    "CATAATATTGGACAGTAA_CGTATATTAGAGATAGAT" => "D12S1301",
    "GGTGTGATTAGCATGAGC_TCAAATTCAACCATCATC" => "D12S1056",
    "TTTGCTTTGATTCCTAAA_AATAAGCATTTGTTGAGG" => "D12S375",
    "TGTTGCTTCCAAGATTAG_GTGTGATAGACAGTTGGA" => "D12S1297",
    "TCCTGCTTCAAGCCCTGA_TTGCTACCCTCTCTTTCT" => "D12S1064",
    "CTCTGTCATCTGTCTGTC_TAAATGCTACAAGGGCAG" => "D12S1030",
    "GGAATAATCATTGTAGAT_GCAGCTTCGAGTTAACAA" => "D12S1023",
    "GGACTTTCTAGCCTATTG_CAATCTCTATTTCTTCAG" => "D13S1493",
    "AGAATCCTTCCAGCTAAT_CAGCTTAAGTTCTTTAAG" => "D13S325",
    "ACACACCTATATACCTTC_CAAAGGTTTAAAAGCAAC" => "D13S1492",
    "TGTTAAACTATCATCTGT_CACCTTCTTTGACTGGAG" => "D13S801",
    "ACCTATCGCTATGCCTGT_TCAATTAGGCACTCTCTC" => "D13S1824",
    "TGCCCTACCTCCTGTAAT_GTTTCCTCTTTGCATCTG" => "D13S792",
    "GACTCTGACCCATCTAAC_GCCATAGGCAGCCCAAAA" => "D13S317",
    "CAGCCCAGAGATGCTGAA_TGACATTCATCGATATTC" => "D13S790",
    "ACATGAACTATGATTCAT_TCAAGTCATGTGTTTGTA" => "D13S793",
    "TGTTTGGTAGCTTAATTA_TCACAGATATGGAGGGAT" => "D13S796",
    "CCAGAGAAGCAGAACTAA_ACACGTATATTCCAATAA" => "D14S742",
    "TGCCTTTTCTTTTCTGGA_AGAAAGGTCTCCATAAAG" => "D14S1280",
    "TGGTACAGGTAGATAAAT_CCATTATATATGCTATGT" => "D14S608",
    "TGTACCTGTCACTGGTCT_GGAGCTTATAACTACTAC" => "D14S741",
    "AGTAAATCTCTAGATAGA_AGAGCTTTAGATCTCTAT" => "D14S1432",
    "CATTCACCAAATTATATT_CACACTTTATGCCAGATG" => "D14S748",
    "CACATGAGGCAATTCCCA_GCCTTCTGTGTTGTCTTT" => "D14S747",
    "TGGCGTGTTCCACTCTTT_AGTGGGAAAGACAGATAA" => "D14S125",
    "TGCTTGGGTTCGAATGCA_GGATTGCTGCCGAAAGAA" => "D14S588",
    "TGGTTGGTTGTTACACAG_TCATGGAAAACCTCCTCA" => "D14S126",
    "AGTGAGCCAATTCCTTGT_TCCGGAGCAGTGGTTTAA" => "D14S1434",
    "GCCTGGGCGACAGTAATG_CCAGAGAGACAGAACTGA" => "D14S1426",
    "TTATCGAGAGCAATGGAA_GGTCAGCCTCCATAATCA" => "D15S817",
    "CCAGCAGCTTAGATTGAT_GCCAAATGATAATTCTTC" => "D15S1513",
    "ACCTATTACTCTCTATTT_TTTTTTCAAATATTAATT" => "D15S822",
    "TCCTACCTTTGTTACTCT_GCATTCCCTATCCTGTAA" => "D15S1232",
    "CGTCTTCCCAACATAACA_TTTATGTGTGGATAGACA" => "D15S659",
    "TGTTGGATGGGAATTGAT_CACAGCTGAGGGAATCTG" => "D15GATA153F11",
    "AAGATCACATCTGTTGGC_ACATGCACACTGCCTACT" => "D15S1507",
    "TGAATTGGAAATATACGT_TGCGTCACTGCTACTGGG" => "D15S1514",
    "CCATCAGCTCCTCCAAAC_TGCTTGAAAAGGGAGGCA" => "D15S642",
    "CCATTCCATTTCCTAACT_ATTTCACTCTAGCTTGGG" => "D16S2622",
    "AAGGGTAATTGGACTCTG_CCTATCTCTATCCATGTA" => "D16S2619",
    "GCTCAGAGATTCTCAGAA_TTCCTCTTAGCCTTGGTC" => "D16S769",
    "TGTGTTCAAGCATGGGTG_TTACAATAGCACCACTCC" => "D16S3253",
    "GGGGAGATCCTGCCTCTA_GGAGTGCCTGAAGGAGTT" => "D16S3393",
    "GAGGATTGGAGGAGGGTG_CAACCCTGTCCCTAAGGA" => "D16S752",
    "GAGGCAATTTGTTACAGA_TGAAAAGTAATAATGTAC" => "D16S2624",
    "GGGGACACATGAGACCCT_TCAGATCATTCTTCCCTT" => "D16S2625",
    "CTGCCCTGCATTACAATT_CCAGTCTTCCGTCACTAT" => "D17GATA158H04",
    "ACCCTGTCTCAGATAGAT_TAAGGTGAGGAGGTGCCA" => "D17S974",
    "CAACCATCAGTGATTTGA_TCTTAATCCTTAACCAGT" => "D17AC001348A",
    "ACCTACTTAACCTTATTC_CCAGTCCATGTATATCTG" => "D17S2196",
    "AGTGAGACCCTATCAAGA_ATTTTCTTTCTTTCCTTA" => "D17S1294",
    "AAGTCGGTGCATTATGGG_CCTATACTTTAAAAAAAT" => "D17S1299",
    "CAACAGAGCAAGACTGTC_TCTCCCTGTGCCCTCTAA" => "D17S1290",
    "GTATTCTCTGCCCAATTT_GATACATGCTCTACATAC" => "D17S2182",
    "TCTTGACAGGGAGGTGGT_CCTGGCCAGATTTTTCTT" => "D17S1535",
    "TGCCATGTAAAAATACAT_TGAAGGTAAAAATGTGTA" => "D17S1301",
    "ACTCCCTGATTTTTAGCT_TCCCCTAATAAATGCCCT" => "D18S976",
    "AGATACTCATTTATACCC_TGTGTGTTTATTTGTTTG" => "D18S869",
    "TGTGTGAGCCAGTCCTTC_CTGGTGTTAGTCCTCTGT" => "D18S536",
    "GACAAAAGCCACACCCAT_CAGAAATATAGATGAGAA" => "D18S535",
    "GTGGATCTTGAGATTTCT_GGTTCTCCAGAGAAACAG" => "D18S972",
    "TCTTGTGAGCCAATCCTT_AACAGAACCAATTGAAGA" => "D18S548",
    "ACTCTGAGTGACAAATTG_CTATTTCTTTTCTTTTTC" => "D18S51",
    "GGTTCATCCAAACATGGT_CCACACAACAGTATTCTT" => "D18S1367",
    "CCAACAGACAAAGGTTAC_CCTAACCAAAAATATGCA" => "D18S1358",
    "AGGGATTTCTACAGACAG_GAGCCAATTCCCCAAATA" => "D18S870",
    "AGGGAGAATCACTCTTCA_CAACCTGGGCAAAAGAGG" => "D19S1165",
    "CCTAACTCAGGCGGCCAA_GGTGACAGAGCAAGATTC" => "D19S1036",
    "CATCATCTATCAAGGTGA_AAAAAGATAAAGCTCAAG" => "D19S719",
    "GCTCTAGGAAGGCAGGGT_TGCCTCTATAAATAAATA" => "D19S400",
    "CACAAGAATCTGTATTAG_CTCACCTTCCATAATTGC" => "D20S604",
    "TTAAGTGATTTGTCCACC_CTTCCAACTGGTATCTTG" => "D20S161",
    "CAATTATTAACGTTTTGC_GGGTTCAGAAAAGATTAG" => "D20S1145",
    "ATTTCTGGGCTGGCGGGG_CCATCCTAGCTAGCCAAA" => "D20S607",
    "TGAGGAAAAAGCTCTCTG_AAGAGAGGAAAGGATGAT" => "D20S481",
    "AAATAAAACAATAAACTC_CAGACCACACTTATAGAA" => "D20S480",
    "TGTGTATTTCTCTCTCTC_CCACTCCATGCATCTATA" => "D20S469",
    "CCTCACATTTTGGAATTC_GATGACTGGATGGATGAA" => "D20S430",
    "GGAAGCGTGTACTAGAGT_CCTCCATATCCACATGAA" => "D20S482",
    "TGTAGACAGCCTATTGTG_TTCTTAGAGGGACAGAAC" => "D21S1432",
    "CATGTACATGTGTCTGGG_GTATTCTCATTTCTCTAC" => "D21S1437",
    "TCAAAGGTCTATACAAGC_GTAACACTAATACCTGGT" => "D21S1409",
    "CATTCCCCTCTCCAATTG_TGAGTCCTGTGAAATGAT" => "D21S1435",
    "CCAGTGCACAGACTGTAC_TAAGACTTCTCGATCTCC" => "D21S1442",
    "GAAACCACTCTAAGACAT_CTTCCCTTGTAGGTACAG" => "D21S226",
    "AAGATGGCATGAGTATGT_CGTTGCAGGGAAACCACA" => "D21S1413",
    "AGCAAGACACCATCTCAA_TGAGAAATTTTACATTTA" => "D21PentaD",
    "TTTATGTATTTACTATAC_ACTGGTAACTAACTGTTA" => "D21S1446",
    "GGAGCCAATTCACCTAAT_CAGAACCTATAGCATGCA" => "D22-GATA198B05",
    "AAAAATAATTGAAGTAAG_GTATCGCTGGTTAGACTG" => "D22S686",
    "TGATTGCCTGGATGACTG_GTGACAGAGCAATAACCT" => "D22S533",
    "AAGACCAAACATAGTAAG_CAATTAACCAGGCCTGTA" => "D22S691",
    "CAGGACAGTTCATGGAGC_TGTATCACTTCTGATGTT" => "D22S1265",
    "CATGCGGTGGACTAGCCA_GGCAATAGAGCAAAACTT" => "D22S692",
    "TCCTAGCCTTCTTATAGC_GCGAATGTATGATTGGCA" => "D22S1045",
    "TGAGAGATGGAGTTTGCC_TGGTACCATTCACAAACA" => "D22S534",
    "GCTTGAAGAAGGAGCTCA_CCTGGCTGAGGAGACGAT" => "D22S444",
    "AGACTTTATCATAAGTAA_GTAAAAATACTCCCACCC" => "DXS6807",
    "TTCTGTCGGCTGAAATTA_AATACACATTCATATCAG" => "DXS9902",
    "CACCATACCCAGCCCTGA_TGAAAGCCACAAATAATC" => "DXS6810",
    "GGTGCCAAACTCTATTAG_TGAGCCCATTTTCATAAT" => "DXS7132",
    "AGTGTTTTTCCAAGTTAT_ACCTAGACTACCTCTGCT" => "DXS10075",
    "CTCAAAACAAAAAGGAAC_ATATTCACCTAGAAATGT" => "DXS6803",
    "CGAGCACACCTACAAAAG_GCATCCAGATAGACAGAT" => "DXS9898",
    "CCTAGAGGGACAGAACCA_CATGTAAGTTGGTACTTA" => "DXS6789",
    "AGGTGTAGCTTCCTTAGA_CATCTTCCAAGAATCAGA" => "DXS7133",
    "CTTCTGCAAGCCATTTGG_ACCTCAGTTCAAAGAAAT" => "DXS7130",
    "TGAATAATCTATGTATCA_AAAAGTTGACTGTGATTC" => "DXGATA165B12",
    "CATCTCTGTCTCCATCTT_CCCCTGTCTATGGTCTCG" => "DXHPRTB",
    "GTGCCCAAAAGATATTTG_CCCTTTATCACCCAGATT" => "DXS7423",
    "TTATTTGTCATTCCTAAT_AAAAATGAGGTATGTCTC" => "DYS393",
    "GGTAGAAATCCTGGCTGT_AACCTAAGCTGAAATGCA" => "DYS570",
    "CTCAGCCAAGCAACATAG_GGGAGTAATAAGCGTATT" => "DYS576",
    "AATGGATAGACATAGGTG_AGTGAGAGCCGGAACCTC" => "DYS522",
    "CTATAAGTTATCTTTAGC_GCTCAAGGCATAGTTCAA" => "DYS443",
    "TTCAATCATACACCCATA_GGTTGCAAGCAATTGCCA" => "DYS391",
    "GCACATACATTGTTTATA_CTCACTTCAAGCACCAAG" => "DYS635",
    "AGATACATAGGTGGAGAC_ATGCCTGGCTTGGAATTC" => "DYS439",
    "CTCTCCAGCCTGGTGATA_GGCTTTCTTGTCTGTAAT" => "DYS641",
    "CAGGTGTTCACTGCAAGC_CCCCCAAAATTCTACTGA" => "DYS643",
    "TGTCCGTCCATCTCTATC_TGGATGAAGGGAGAGCAG" => "DYS513",
    "TCTATCAATCTTCTACCT_TGATCAGTTCTTAACTCA" => "DYS533",
    "TGCTGTGTCACTATATTT_ATGGATAGACAGATATAT" => "DYS461",
    "TCCATATCATCTATCCTC_TAGCAAGCACAAGAATAC" => "DYS460",
    "GAAAGCCCCATTCCCTAG_TGGGTAACAGAGAAAGAT" => "DYS445",
    "TGTGGTGATGATTTCATA_CCAGCCCTTAACAGCTTT" => "D1S1597",
    "TTCTGCTGTACACGTATG_AACCTGGCCTGTGTTAAA" => "D1S3669",
    "TGAGGAAGAAAGGAGGAA_TTTGCCTTGGACTGGAGC" => "D1S1676",
    "CGGTGACAGGTAGGTAAG_GTCAGTTGGCATTACACT" => "D1S3467",
    "TGTGCTCATTTTTAACTG_TGCCAGAGAATAGGGTGA" => "D1S551",
    "TCGAGTCAGCAGTGTGAC_CTCTAACCCAGGGACAGT" => "D1S1588",
    "CACATACCAATGGCGGAG_TGCCAATTATCTCGCACC" => "D1S1631",
    "ACATAGCAGGCACTAGCT_CCCAAAACCCATCTCTCT" => "D1S534",
    "ACACTCCCACCTGGATGA_CTATGGAGGTGGCAGGAG" => "D1S1653",
    "CCTTCCATAGCTGATACT_GCAACAGAGTGAGACTCC" => "D1S1165",
    "TCTTTTTCTGGCTTCATG_TTCAACACTACAGTGAAC" => "D1S1589",
    "TGTGGGACTTGGCATCCA_GTTAGAGTGCTCCTAGGA" => "D1S2141",
    "GTTTGTGTGTGTAAAACA_CCAGCAATGGGTAGTATG" => "D1S549",
    "TCTAGAGAGAGAGAACCA_TCCCTAATAAATCCCTTC" => "D1S1644",
    "TGCCTGGAAAAACACAAG_CCATCAATGGTAGATTAG" => "D1S517",
    "GTGACTAAGTTAGCACAC_CTCGAAATCCTAATCTAA" => "D1S1609",
    "GGAAATTGATAATGATAG_TTATCCTTAGCCCTTCCC" => "D2S1394",
    "TTGTATCTCTTTCCATGG_GCCAAAGCAGCAAAACGA" => "D2S1387",
    "AAAAATTAGTCGAGCATA_CCCAGATCATTTCATGGC" => "D2S274",
    "AGAATGGGAGCAACATGA_AATCAGGCTGCTCACTGT" => "D2S436",
    "GTTATGTAGAAGAGTCAG_TTAGTTTTACACACACAG" => "D2S410",
    "GGATTCATGCAGTTCAAA_ACGGATGCAGAGGATGTA" => "D2S437",
    "AACTACATTGGTCCAGGT_GGTCAGTTGCTTTTGGAA" => "D2S1399",
    "AGTAGAAGCCAGGGACAT_AACCCTGGCAGTATTGAT" => "D2S1353",
    "CCAACTTCCTACTTGGTG_TGTTCCCAGAAATCTGGG" => "D2S434",
    "GGATGTACAAATGGGTAG_GCTGGGTCCTCAGTCTTT" => "D2S2968",
    "TCAAGTGCAGCCTGACTT_GCTCAATGATAGGTGATT" => "D3S3050",
    "CAGAACATTCTGCTCGCA_TGTTTAAAGTTACACGGC" => "D3S2431",
    "TTTTCAACTGGCTTTGAC_CCCTGCCTACATGTTAGT" => "D3S4547",
    "CTTCTCAGCCTCCATGAC_AAATTAGTAATTATATTA" => "D3S1766",
    "CCAAATTGTGTAAGTTCA_TCTCTCTCTTTCTGTGTG" => "D3S2454",
    "GGGAAACATATTATGTCT_AAACTGGTTTGGGTCTGT" => "D3S2459",
    "ATAGCATTGCTTCCCCTT_AGTGAGTACAGAAATACT" => "D3S2460",
    "AACAAATTCTTAATTGGA_CTCAGAGTCCCTGGGTGA" => "D3S1764",
    "TCAAAACCAGGAGTAAAA_TCAATCTAATTGTGAAAA" => "D3S1763",
    "ACAAACTTGTACATTCTG_TTCAGGACTGTAGGATTC" => "D3S2418",
    "GAAACACTTTTCATTCCT_GGCATGGCATACTATGCA" => "D4S2397",
    "CCCTCCTGAAAAACACAA_CAGACAAAGGAAGTTTGA" => "D4S1627",
    "GAGTTGAGAAGAAAGGAA_GCAAGTAAATGGGCTATC" => "D4S3254",
    "CAATGTCATAGAAGAGAT_TGAAAAAATGCAGTGGGC" => "D4S3248",
    "CCAACACCCCTGCTACTT_TTAAGCAAAGAGGATTGA" => "D4S1647",
    "AGTCCTGAAGACATCTTG_GATTAGGAGACAGGTAGG" => "D4S2417",
    "TGTATTTTTATAAGGAGG_TGGTTTTCATCATGAGAT" => "D4S2390",
    "ACTCCTATATCATTGTTT_CAGGCTCAGAAGGAACTG" => "D5S2488",
    "TTTCCTGAGGTTTCTACT_CAAATGTGCGCATCCATC" => "D5S807",
    "AGCACAGCTCATCTTCCC_AGAGAAGGGCCTAAACAA" => "D5S1486",
    "TCTCTTCATGTCTCTCTC_ACTATATTCCCCAGGCTG" => "D5S1470",
    "TGGGTAAATATCTTATTC_TCAAAGTGTTTAACCTTT" => "D5S2507",
    "TGCATCCTTCTCTGATTA_AGTAAAAAGAACTTAGTT" => "D5S806",
    "TGGTTCCTGTAATATGAT_AGAATAAATGCAAATCTA" => "D5S1459",
    "TCATAATCTGGGGGAAGT_GGTAGCTCTTGTGTCAAT" => "D5S2501",
    "TTATCTGACACTTTTCCT_GAATTCAGCATGGCCTCA" => "D5S1484",
    "GGACCAAATAAATGAATA_AAGAGCTATTGCCACTGA" => "D5S816",
    "GGTCCCTGCCTACTGATT_TGGCTGTGATATATATAG" => "D5S1480",
    "TTGTAGGTCAAGGAGCAT_TCATTTAAATGAAAGAGT" => "D5S1456",
    "AGGGATTCCAGGCCAAAT_TTCTGACAAATTGCTCCC" => "D6S1279",
    "TCTTTTGCTGGCTCTGCA_CATTAGAAGCAGATCCAT" => "D6S1266",
    "CACTTAGAGTATTCCAGC_AACAAAGCGAGATGCCAC" => "D6S1281",
    "GGGACCTTGTGATCATGT_AGTCAGGTTTCCATAAAG" => "D6S1053",
    "GCCTCATTTTATCTACCT_TGCCATCAATGAGTTCAG" => "D6S1031",
    "GGACCTATAAATAGCTTG_AGTTTCTAAGACAAGATT" => "D6S1021",
    "TGGAAAAATACATAAATA_TCCAGTATGGGTAGGCTA" => "D6S1040",
    "CATCTTGTTGGCATAAAA_AACAGAGTGAAAGACCCT" => "D6S1009",
    "TCTGTGTCAACTGTTATC_TGTTCAAGGGTCAACTGT" => "D6G15833",
    "GAAAACTCAAGCTCAGAA_CTTGAATCCAGGCATTCA" => "D6S1035",
    "TCACAGAACTTACAAGTG_TTAACCCTGCTAACAACA" => "D6S1277",
    "TCTGTATATGGACATAAC_GAGTTCCATCCCTCCTCC" => "D7S3051",
    "TCCAGGTGGCTGAGAGAC_AACTGTTGCCTAGTGAAA" => "D7S3053",
    "AGCTTTAACAGATGTCAG_CCTCCTCAACTTCCAGAG" => "D7S1813",
    "TCCCAAAACCACTTAAGT_TGCAATTACTTTTGTACC" => "D7S1817",
    "AGTCCTGACCTAACCTTC_CTGTGTGACTGTGTGAGA" => "D7S1824",
    "AGCCAGAGTAACCCTTTA_GCAGATCCTCGTATGGGA" => "D7S1823",
    "GCAGGTTTTCCAAAGGGA_GATTAAAGAAGCATTATG" => "D8S1458",
    "TTCCACCAGCAGTGTGTA_TGTGCCCATCTGTGTGTA" => "D8S1116",
    "GATATCTCTCTCTCTTCT_TGCTTCCTTTACTTTTTA" => "D8S593",
    "TGTCACAGTGGTTTATTT_TCTGCCAATGATTGAAAT" => "D8S2324",
    "CAAGGAGAAATGGAATGC_CCAGCCCAGAGTGAATTT" => "D8S1119",
    "TTATTGTTATCAATCTCT_CACAGATAGTCCTGAACT" => "D8S1471",
    "CCAGGCTACATTTCCAAA_TAGAGCCTACCCACCCCA" => "D8S1128",
    "GGCAGCTATTTTTGTAGG_TCCTCTTGGGTCTGAGTT" => "D8S1100",
    "GGACCACTGCCTAAGGAA_CCAAGAAGGTGGCCATCC" => "D9S922",
    "CCAAAATCAGGATTTGGA_CTCCAGTGCTCTCTAGCT" => "D9S253",
    "CAAAAATTAGCGTGTGTG_GCTACTGCTGGGAATACC" => "D9S2157",
    "ACTAGTGTTATGACACTT_TGTGTTATGTGTGCATGT" => "D10S2481",
    "TTAAATCAAGGTCTTTCA_CGGTAAGAGAAATGGCTG" => "D10S1208",
    "CCCTGCATCCACCTTTGC_AATAGAGGCATTAACTAG" => "D10S1221",
    "CCTTAACTGGCGACATCA_AAGGTTACTGAGTCACAG" => "D10S1427",
    "TGACAGAGTGAGACCCTG_ACTTGATAGCTAAAGTAT" => "D10S1239",
    "CAGAGACTCTGCTAAGCA_CAGTATTGTTTAGCACAG" => "D10S1230",
    "GGACACAGGTCCCTGGGA_GGTTGGATGAGGCAATAG" => "D10S2322",
    "TCAGAATGGACTATAGGA_CTAGTATCCACTTCCTGG" => "D11S2362",
    "CACCAGTAAGAAATGAAT_CCAATTGACAGTGGATTT" => "D11S1997",
    "AGTAGATGCTCCATAAAT_CCCAAATATCATGTGCAA" => "D11S4465",
    "GCAGTGTGAAAACAGACT_TTGCATTTTCTTTTGTGC" => "D11S4952",
    "TCAAATATTCTCTCTCTC_TGTGAAATGTGCCAGTTA" => "D11S2000",
    "GCAATTAAAGAGCTTATC_TCACTGAGTCATGTTGCA" => "D11S4464",
    "GCAGAGGACTTTGGAAGC_GCATTGCTGATAGTAAGT" => "D11S2367",
    "CAGTGGAAAGCAAAATGG_GGTATAATATAGTTAGCC" => "D12S1072",
    "AAATAATTTCTACCTCAC_TGTAACATCCGTGATAAA" => "D12S1300",
    "CAATGGGCAATAACTTCT_CACTTTACCTCGATGTAA" => "D12S395",
    "CCATCCTTCTTTTTATGA_GACCTTTTGAAATCTTCC" => "D12S2078",
    "GGACTTCTCAGCTTCCTT_ACAGAACTGAGATAGAGA" => "D13S800",
    "CATCCAGACTCCCCAGCT_CCCCCTTTTCTGGAATTA" => "D14S121",
    "GCTTAAGAGGATATCCTC_CCCAGACTTAGAAAAGCT" => "D14S592",
    "CAAGATCATGTCACTGTA_ACATAAGCCTGCCTACAT" => "D14S617",
    "GCTATACCTTGTATTTAT_GAGGGTTGAGGGTTTAAT" => "D15S643",
    "CAGAAAGCCAGGTCCCTT_CCAGGATACACTGCAAAT" => "D15S652",
    "CGAGTCAGGCGAGTTTTT_AATAGAAACACAGGAGAT" => "D15S816",
    "TGACAGCTACAGGCATGT_GCTATGGAAGAAACAGAG" => "D15S1515",
    "TGCTTTAAGACAGAAGAA_ACAACAAGTGTGCCTTCT" => "D16S771",
    "CCCGGTTGTCAAAAGAGG_AAAAGAGAAAGTGAGAGA" => "D16S2620",
    "CCCGCCTCAGGTAGGTGA_TCCATAGTCATATGGGCC" => "D16S2621",
    "ACACAAATAAATATCCAT_TGTTTTATGGTAACTTAC" => "D17S1303",
    "GCATAGATGATAGTAAGG_CCAGTTATTCAGAGATTC" => "D17S2193",
    "CTGACTTAGCCTTGGAAG_CCCTCATGAAATGTTAAT" => "D17S968",
    "GGGCCTATGTTTCCAGTA_GCCAAATACTGTGTTTCC" => "D18S1370",
    "ACCCAGTTAGACTTCACT_TGTGACTTGAGGAAGAGA" => "D18S973",
    "GCTCTGCCACTAACTAGT_CTTCTGCTGGTGTAGTAA" => "D18S843",
    "GGAAACCAAACTACAACG_AGGTCACCTACAACTTTG" => "D18S542",
    "AAATATGCAAAGTATAGC_GCTTTATCATGCTCTTCA" => "D18S877",
    "TCTCCATAATCACATGAT_CAGAGAGACAGAACCAAT" => "D18S847",
    "GGGACTTGTCAGATTCCA_GCATTCTTTGGATAAACT" => "D18S978",
    "AATAAATATATAGTTATA_CTTTATGAAGCAGTGATG" => "D18S851",
    "AGGGCCCCAATACAGGAG_AGTCTGTAGAAAGCAACA" => "D18S1364",
    "TCTCTCTCTCTTCATCCA_CCTGTGTTGTGAGATTCA" => "D18S1371",
    "ACTAATTGATTACTATAG_CCCAGATAAATACAGATA" => "D20S473",
    "AAAAGTGCATGCACTGGA_GGCATTCTTCCCTTGTGT" => "D20S603",
    "AGAAAGGCAGATAGACAG_CCATCTGGGGCCCAAAAT" => "D20S162",
    "TCGACTGACAATATTTCA_ACATTGTAAATATGTTAT" => "D20S1085",
    "CATTCCAGCCTTGCAAAA_TCTTCTACTTCCACTTCT" => "D20S468",
    "TCATGGCACTTGTATACC_TAGAGGTGGCAGAAGGGA" => "D20S1082",
    "ATCTCAATTTGAGTTTGA_TCACCTACATTAGTCTGT" => "D22S685",
    "CGGCAAGACCCTGTTTTG_GCCAGCTTTTTACCTTAT" => "D22S417",
);

my ($sample) = ( $ARGV[0] =~ /^(.+)\.uniq/ );
print OUT "str\t$sample\n";
my %hash;
while (<FILE>) {

    chomp;
    my $name = $_;
    my $seq  = <FILE>;
    my $tre  = <FILE>;
    my $qual = <FILE>;
    chomp($seq,$tre,$qual);
    my @name = split(/\t/,$name);
    my $str = (split/\_/,$name[0])[1];
    my $num = (split/\:/,$name[1])[-1];
    $hash{$str.'_'.$seq} = $num;
    $hash_num{$str} += $num;
    #print "$str\t$seq\t$num\n";
    
}

my @num = "";
foreach $str_name ( sort { $a cmp $b } values %len) {
    if ( exists $hash_num{$str_name} ) {
        foreach $type_name (sort {$hash{$b} <=> $hash{$a}} keys %hash ) {
            @type_name = split( /\_/, $type_name );
            if ( $type_name[0] eq $str_name ) {
                $num = $type_name[1] . '|' . $hash{$type_name};
                #print "$num\n";
                if($hash{$type_name}/$hash_num{$type_name[0]} >0.01 and $hash{$type_name} >1){
                    
                    push @num, $num;
                }
            }
        }
        shift @num;
        $str_type = join( ";", @num );
        if ($#num >=0) {
            print  OUT "$str_name\t$str_type\n";
        }
        else {
            print  OUT "$str_name\tNA\n";
        }
        @num   = "";
       
    }
    elsif ( !exists $hash_num{$str_name} ) {
        print OUT "$str_name\tNA\n";
    }
}
